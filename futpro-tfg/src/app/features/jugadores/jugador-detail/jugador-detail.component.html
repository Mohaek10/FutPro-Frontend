<section class="container mx-auto mt-20 p-5 bg-white rounded-lg shadow-lg">
  <div *ngIf="jugador" class="flex flex-col lg:flex-row">
    <div class="lg:w-1/3 p-4">
      <app-jugador [jugador]="jugador"></app-jugador>
    </div>

    <div class="lg:w-2/3 p-4">
      <h3 class="text-3xl font-bold mb-4">Comentarios</h3>

      <div class="mb-4" *ngIf="estaLogueado">
        <form [formGroup]="comentarioForm" (ngSubmit)="onSubmitComentario()">
          <mat-form-field appearance="fill" class="w-full mb-4">
            <mat-label>Calificación</mat-label>
            <input matInput type="number" formControlName="calificacion" min="0" max="5">
            <mat-error
              *ngIf="comentarioForm.get('calificacion')?.invalid && comentarioForm.get('calificacion')?.touched">
              Calificación debe ser entre 0 y 5
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full mb-4">
            <mat-label>Comentario</mat-label>
            <textarea matInput formControlName="texto" maxlength="200"></textarea>
            <mat-error *ngIf="comentarioForm.get('texto')?.invalid && comentarioForm.get('texto')?.touched">
              Comentario no puede estar vacío y no puede tener más de 200 caracteres
            </mat-error>
          </mat-form-field>

          <button mat-raised-button color="primary" type="submit" [disabled]="comentarioForm.invalid">
            Enviar
          </button>
        </form>
      </div>

      <div *ngIf="!estaLogueado" class="text-red-500">Debes estar logueado para comentar.</div>

      <div class="mt-6 space-y-4">
        <mat-card *ngFor="let comentario of comentarios" class=" p-4 rounded-lg shadow-md">
          <p class="font-bold">{{ comentario.comentario_user }}</p>
          <p>{{ comentario.texto }}</p>
          <p class="text-sm text-gray-500">Calificación: {{ comentario.calificacion }}</p>
          <p class="text-sm text-gray-500">{{ comentario.createdAt | date:'short' }}</p>
        </mat-card>
        <div *ngIf="comentarios?.length === 0" class="text-gray-500">No hay comentarios.</div>
      </div>
    </div>
  </div>
</section>
